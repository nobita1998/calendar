<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Binance Booster - XNY ç¬¬å››æœŸè§£é”</title>
  <link rel="icon" type="image/png" sizes="1024x1024" href="icon.png">
  <link rel="apple-touch-icon" href="icon.png">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #0c0c0f 0%, #1a1a23 100%);
      color: #ffffff;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(23, 23, 31, 0.8);
      border-radius: 16px;
      border: 1px solid #2b2b40;
      backdrop-filter: blur(10px);
      padding: 30px;
      box-shadow: 0 20px 60px rgba(240, 185, 11, 0.1);
    }

    .header { display: flex; align-items: center; gap: 12px; margin-bottom: 40px; }

    .title {
      font-size: 1.65em;
      font-weight: bold;
      background: linear-gradient(45deg, #f0b90b, #fcd535);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .subtitle { color: #848e9c; font-size: 1.1em; }

    /* Accordion layout for weeks */
    .weeks-container { display: flex; flex-direction: column; gap: 20px; margin-bottom: 20px; }

    .week-accordion {
      background: rgba(23, 23, 31, 0.6);
      border: 1px solid #2b2b40;
      border-radius: 12px;
      overflow: hidden;
    }

    .week-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 25px;
      background: linear-gradient(135deg, rgba(240, 185, 11, 0.15) 0%, rgba(23, 23, 31, 0.8) 100%);
      border-bottom: 2px solid transparent;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .week-header:hover {
      background: linear-gradient(135deg, rgba(240, 185, 11, 0.25) 0%, rgba(23, 23, 31, 0.9) 100%);
    }

    .week-header.active {
      border-bottom-color: #f0b90b;
    }

    .week-header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .week-toggle {
      font-size: 1.2em;
      color: #f0b90b;
      transition: transform 0.3s ease;
    }

    .week-toggle.expanded {
      transform: rotate(90deg);
    }

    .week-title {
      font-size: 1.3em;
      font-weight: 700;
      color: #f0b90b;
      letter-spacing: 0.5px;
    }

    .week-info {
      font-size: 0.95em;
      color: #848e9c;
      margin-left: 15px;
    }

    .week-total {
      font-size: 1.1em;
      font-weight: 600;
      color: #26a69a;
    }

    .week-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
    }

    .week-content.expanded {
      max-height: 2000px;
    }

    .week-tasks-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      padding: 25px;
    }

    .task-card {
      background: linear-gradient(135deg, rgba(240, 185, 11, 0.1) 0%, rgba(23, 23, 31, 0.9) 100%);
      border: 1px solid #2b2b40;
      border-radius: 12px;
      padding: 15px;
      position: relative;
      overflow: hidden;
    }

    .task-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, #f0b90b, #fcd535); }

    .task-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .task-title { font-size: 0.95em; font-weight: 600; color: #ffffff; }
    .task-percentage { font-size: 1.05em; font-weight: bold; color: #f0b90b; }

    .progress-bar { width: 100%; height: 8px; background: #2b2b40; border-radius: 4px; margin-bottom: 10px; overflow: hidden; position: relative; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #f0b90b, #fcd535); border-radius: 4px; position: relative; width: 0%; }

    .task-footer { display: flex; justify-content: space-between; align-items: center; }
    .task-reward { font-size: 0.95em; color: #26a69a; font-weight: 600;  }

    .summary-card { background: linear-gradient(135deg, rgba(240, 185, 11, 0.2) 0%, rgba(23, 23, 31, 0.9) 100%); border: 2px solid #f0b90b; border-radius: 8px; padding: 15px; text-align: center; margin-bottom: 20px; }
    .summary-title { font-size: 1.1em; color: #f0b90b; margin-bottom: 8px; font-weight: 600; }
    .minimum-coins { font-size: 1.8em; font-weight: bold; color: #ffffff; text-shadow: 0 0 20px rgba(240, 185, 11, 0.8); }
    .coin-symbol { color: #f0b90b; margin-left: 10px; }

    .watermark { text-align: right; color: #848e9c; font-size: 1em; opacity: 0.8; margin-top: 20px; padding-right: 10px; }

    .lottery-section { background: linear-gradient(135deg, rgba(38, 166, 154, 0.1) 0%, rgba(23, 23, 31, 0.9) 100%); border: 1px solid #2b2b40; border-radius: 12px; padding: 25px; }
    .lottery-title { font-size:  1.45em; color: #26a69a; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }

    /* Four columns for lottery, each column = one week */
    .lottery-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
    .lottery-column { display: flex; flex-direction: column; gap: 12px; }
    .lottery-week-title { text-align: center; color: #26a69a; font-weight: 700; font-size: 0.95em; }

    .lottery-item { background: rgba(38, 166, 154, 0.1); border: 1px solid rgba(38, 166, 154, 0.3); border-radius: 8px; padding: 16px; text-align: center; }
    .lottery-emoji { font-size: 1.6em; margin-bottom: 8px; }
    .lottery-rate { color: #26a69a; font-weight: 600; margin-bottom: 4px; font-size: 0.95em; }
    .lottery-reward { color: #cbd5e1; font-size: 0.9em; margin-top: 4px; }
    .lottery-usdt { color: #cbd5e1; font-size: 0.9em; margin-top: 4px; }

    /* Back link */
    .back-link { display: inline-block; background: linear-gradient(135deg, #0ecb81 0%, #1dd1a1 100%); color: #000; font-weight: 700; padding: 8px 12px; border-radius: 8px; text-decoration: none; box-shadow: 0 2px 8px rgba(14,203,129,.3); }
    .back-link:hover { transform: translateY(-1px); box-shadow: 0 4px 16px rgba(14,203,129,.5); }
    .back-fixed { position: fixed; top: 16px; left: 16px; z-index: 1000; }

    @media (max-width: 1024px) {
      .week-tasks-grid { grid-template-columns: repeat(2, 1fr); }
      .lottery-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      body { padding: 10px; }
      .container { max-width: 100%; margin: 0; border-radius: 16px; padding: 20px; }
      .header { margin-bottom: 20px; }
      .title { font-size: 1.35em; }
      .subtitle { font-size: 0.95em; }
      .week-tasks-grid { grid-template-columns: 1fr; gap: 12px; }
      .week-header { padding: 15px 20px; flex-direction: column; align-items: flex-start; gap: 10px; }
      .week-header-left { flex-direction: column; align-items: flex-start; gap: 8px; }
      .week-title { font-size: 1.1em; }
      .week-info { margin-left: 0; }
      .week-total { font-size: 1em; }
      .week-tasks-grid { padding: 15px; }
      .task-card { padding: 12px; border-radius: 10px; }
      .task-title { font-size:  0.95em; }
      .task-percentage { font-size:  1em; }
      .progress-bar { height: 6px; }
      .summary-card { padding: 12px; }
      .lottery-section { padding: 16px; border-radius: 10px; }
      .lottery-grid { grid-template-columns: 1fr; gap: 12px; }
      .lottery-title { font-size:  1.2em; }
      .lottery-item { padding: 14px; }
      .back-link { padding: 6px 10px; font-size: 14px; }
      .summary-title { font-size: 1em; }
      .minimum-coins { font-size: 1.5em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="index.html" class="back-link" aria-label="è¿”å›" onclick="if (document.referrer && new URL(document.referrer).origin === location.origin) { history.back(); return false; }">è¿”å›æ—¥å†</a>
      <h1 class="title">Binance Booster - XNY ç¬¬å››æœŸè§£é”</h1>
    </div>

    <div class="weeks-container" aria-label="è¿›åº¦ä»»åŠ¡">
      <!-- Week 9 -->
      <div class="week-accordion">
        <div class="week-header active" data-week="9">
          <div class="week-header-left">
            <span class="week-toggle expanded">â–¶</span>
            <span class="week-title">ç¬¬9å‘¨</span>
            <span class="week-info">(5ä¸ªä»»åŠ¡)</span>
          </div>
          <div class="week-total">720 XNY</div>
        </div>
        <div class="week-content expanded">
          <div class="week-tasks-grid">
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 1</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 120 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 2</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 140 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 3</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 140 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 4</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 5</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Week 10 -->
      <div class="week-accordion">
        <div class="week-header" data-week="10">
          <div class="week-header-left">
            <span class="week-toggle">â–¶</span>
            <span class="week-title">ç¬¬10å‘¨</span>
            <span class="week-info">(5ä¸ªä»»åŠ¡)</span>
          </div>
          <div class="week-total">720 XNY</div>
        </div>
        <div class="week-content">
          <div class="week-tasks-grid">
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 1</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 120 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 2</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 140 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 3</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 140 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 4</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 5</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Week 11 -->
      <div class="week-accordion">
        <div class="week-header" data-week="11">
          <div class="week-header-left">
            <span class="week-toggle">â–¶</span>
            <span class="week-title">ç¬¬11å‘¨</span>
            <span class="week-info">(6ä¸ªä»»åŠ¡)</span>
          </div>
          <div class="week-total">3140 XNY</div>
        </div>
        <div class="week-content">
          <div class="week-tasks-grid">
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 1</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 200 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 2</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 100 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 3</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 100 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 4</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 120 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 5</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 120 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 7</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 250 æš</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Week 12 -->
      <div class="week-accordion">
        <div class="week-header" data-week="12">
          <div class="week-header-left">
            <span class="week-toggle">â–¶</span>
            <span class="week-title">ç¬¬12å‘¨</span>
            <span class="week-info">(7ä¸ªä»»åŠ¡)</span>
          </div>
          <div class="week-total">780 XNY</div>
        </div>
        <div class="week-content">
          <div class="week-tasks-grid">
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 1</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 20 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 2</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 60 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 3</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 100 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 4</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 5</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 120 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 7</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
            <div class="task-card">
              <div class="task-header"><span class="task-title">ä»»åŠ¡ 8</span><span class="task-percentage">100%</span></div>
              <div class="progress-bar"><div class="progress-fill" style="width: 100%"></div></div>
              <div class="task-footer"><div class="task-reward">æ¯äºº: 160 æš</div></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="summary-card" aria-live="polite">
      <div class="summary-title">Summary by ğ•@NNNNNNOBITA</div>
      <div class="minimum-coins">5500<span class="coin-symbol">ğŸª™</span></div>
    </div>

    <div class="lottery-section">
      <div class="lottery-title">ğŸ° æŠ½å¥–ä»»åŠ¡</div>
      <div class="lottery-grid">
        <!-- Week 9 Lottery -->
        <div class="lottery-column" aria-label="ç¬¬9å‘¨">
          <div class="lottery-week-title">ç¬¬9å‘¨</div>
          <div class="lottery-item" aria-label="ç¬¬9å‘¨ æŠ½å¥–ä»»åŠ¡1">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦67% | 50,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 120 XNY</div>
          </div>
          <div class="lottery-item" aria-label="ç¬¬9å‘¨ æŠ½å¥–ä»»åŠ¡2">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦13% | 10,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 200 XNY</div>
          </div>
          <div class="lottery-item" aria-label="ç¬¬9å‘¨ æŠ½å¥–ä»»åŠ¡3">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦53% | 40,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 300 XNY</div>
          </div>
        </div>

        <!-- Week 10 Lottery -->
        <div class="lottery-column" aria-label="ç¬¬10å‘¨">
          <div class="lottery-week-title">ç¬¬10å‘¨</div>
          <div class="lottery-item" aria-label="ç¬¬10å‘¨ æŠ½å¥–ä»»åŠ¡1">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦67% | 50,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 120 XNY</div>
          </div>
          <div class="lottery-item" aria-label="ç¬¬10å‘¨ æŠ½å¥–ä»»åŠ¡2">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦13% | 10,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 200 XNY</div>
          </div>
          <div class="lottery-item" aria-label="ç¬¬10å‘¨ æŠ½å¥–ä»»åŠ¡3">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦53% | 40,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 300 XNY</div>
          </div>
        </div>

        <!-- Week 11 Lottery -->
        <div class="lottery-column" aria-label="ç¬¬11å‘¨">
          <div class="lottery-week-title">ç¬¬11å‘¨</div>
          <div class="lottery-item" aria-label="ç¬¬11å‘¨ æŠ½å¥–ä»»åŠ¡1">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦13% | 10,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 200 XNY</div>
          </div>
          <div class="lottery-item" aria-label="ç¬¬11å‘¨ æŠ½å¥–ä»»åŠ¡2">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦27% | 20,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 500 XNY</div>
          </div>
        </div>

        <!-- Week 12 Lottery -->
        <div class="lottery-column" aria-label="ç¬¬12å‘¨">
          <div class="lottery-week-title">ç¬¬12å‘¨</div>
          <div class="lottery-item" aria-label="ç¬¬12å‘¨ ä»»åŠ¡6">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦13% | 10,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 200 XNY</div>
          </div>
          <div class="lottery-item" aria-label="ç¬¬12å‘¨ æŠ½å¥–ä»»åŠ¡1">
            <div class="lottery-rate">ä¸­å¥–ç‡: çº¦53% | 40,000äººä¸­å¥–</div>
            <div class="lottery-reward">æ¯äºº: 250 XNY</div>
          </div>
        </div>
      </div>
    </div>

    <div class="watermark">X: @NNNNNNOBITA</div>
  </div>

  <!-- i18n & title wiring -->
  <script>
    (function() {
      const LANG_STORAGE_KEY = 'calendar_lang';
      const currentLang = (function(){ try { return localStorage.getItem(LANG_STORAGE_KEY) || 'zh'; } catch(_){ return 'zh'; } })();
      const dict = {
        zh: { back: 'è¿”å›æ—¥å†', summary: 'Summary by ğ•@NNNNNNOBITA', lottery: 'ğŸ° æŠ½å¥–', roundFirst: 'ç¬¬ä¸€æœŸè§£é”', roundSecond: 'ç¬¬äºŒæœŸè§£é”', roundThird: 'ç¬¬ä¸‰æœŸè§£é”', roundFourth: 'ç¬¬å››æœŸè§£é”', headPrefix: 'Binance Booster - ' },
        en: { back: 'Back to Calendar', summary: 'Summary by ğ•@NNNNNNOBITA', lottery: 'ğŸ° Lottery', roundFirst: 'First Unlock', roundSecond: 'Second Unlock', roundThird: 'Third Unlock', roundFourth: 'Fourth Unlock', headPrefix: 'Binance Booster - ' }
      };
      function getMetaFromPath(){
        const p = (location.pathname || '').toLowerCase();
        let token = 'XNY';
        if (p.includes('bas')) token = 'BAS';
        if (p.includes('hemi')) token = 'HEMI';
        if (p.includes('holo')) token = 'HOLO';
        if (p.includes('xny')) token = 'XNY';
        const isFirst = /first/.test(p);
        const isSecond = /second/.test(p);
        const isThird = /third/.test(p);
        const isFourth = /fourth/.test(p);
        const roundKey = isFirst ? 'roundFirst' : (isSecond ? 'roundSecond' : (isThird ? 'roundThird' : 'roundFourth'));
        return { token, roundKey };
      }
      function applyI18n(){
        try { document.documentElement.setAttribute('lang', currentLang === 'zh' ? 'zh-CN' : 'en-US'); } catch(_){ }
        const meta = getMetaFromPath();
        const t = dict[currentLang];
        const titleStr = `${t.headPrefix}${meta.token} ${t[meta.roundKey]}`;
        const h1 = document.querySelector('h1.title');
        if (h1) h1.textContent = titleStr;
        try { document.title = titleStr; } catch(_){ }
        const back = document.querySelector('.back-link');
        if (back) { back.textContent = t.back; back.setAttribute('aria-label', t.back); }
        const sumTitle = document.querySelector('.summary-title');
        if (sumTitle) sumTitle.textContent = t.summary;
        const lotTitle = document.querySelector('.lottery-title');
        if (lotTitle) lotTitle.textContent = t.lottery;
      }
      applyI18n();
    })();
  </script>
  <script>
    (function(){
      function normalizeRewards(){
        var nodes = document.querySelectorAll('.task-reward, .lottery-reward');
        nodes.forEach(function(el){
          var txt = (el.textContent || '').trim();
          var m = txt.match(/^(\s*(?:æ¯äºº|Per person)\s*:?\s*)(\d+(?:\.\d+)?)(\s*(?:XNY|æš|coins))?/i);
          if (m) {
            var n = Math.round(parseFloat(m[2]));
            var suf = (m[3]||'').trim();
            if (!suf) { suf = (/Per person/i.test(m[1]) ? 'coins' : 'æš'); }
            el.textContent = m[1] + n + ' ' + suf;
          }
        });
      }
      try { normalizeRewards(); } catch(e){}
    })();
  </script>
  <script>
    (function(){
      function sumRewards(){
        var nodes = document.querySelectorAll('.week-tasks-grid .task-reward');
        var sum = 0;
        nodes.forEach(function(el){
          var txt = el.textContent || '';
          var m = txt.match(/(\d+)/);
          if (m) sum += parseInt(m[1], 10);
        });
        var min = document.querySelector('.minimum-coins');
        if (min) {
          var sym = '<span class="coin-symbol"> XNY</span>';
          var suf = min.querySelector('.usd-suffix'); if (suf) suf.remove();
          min.innerHTML = String(sum) + sym;
        }
      }
      try { sumRewards(); } catch(e){}
    })();
  </script>

  <script>
    (function(){
      function buildLotteryValues(price){
        var grid = document.querySelector('.lottery-grid');
        if (!grid) return;
        function fmt(n){ try { return (Math.round(n*10)/10).toFixed(1); } catch(_) { return String(n); } }
        var items = grid.querySelectorAll('.lottery-column .lottery-item');
        items.forEach(function(item){
          var reward = item.querySelector('.lottery-reward');
          if (!reward) return;
          var m = (reward.textContent||'').replace(/,/g,'').match(/(\d+(?:\.\d+)?)\s*(?:XNY|æš|coins)/i);
          if (!m) return;
          var coins = parseFloat(m[1]);
          if (!isFinite(coins)) return;
          var usdLine = item.querySelector('.lottery-usdt');
          if (!usdLine) { usdLine = document.createElement('div'); usdLine.className = 'lottery-usdt'; reward.insertAdjacentElement('afterend', usdLine); }
          if (isFinite(price)) { usdLine.textContent = 'â‰ˆ $ ' + fmt(coins*price) + ' USDT'; }
        });
      }
      try { window.buildLotteryValues = buildLotteryValues; } catch(_) {}
    })();
  </script>
  <!-- Price annotation: XNYUSDT -->
  <script>
    (function(){
      const API = 'https://fapi.binance.com/fapi/v1/ticker/price?symbol=XNYUSDT';
      function fmt(n){ const v = Number(n); return isFinite(v) ? v.toFixed(1) : ''; }
      function lang(){ try { return localStorage.getItem('calendar_lang') || 'zh'; } catch(_){ return 'zh'; } }
      function annotateSummary(price){
        const el = document.querySelector('.minimum-coins');
        if (!el || el.querySelector('.usd-suffix')) return;
        const m = (el.textContent||'').replace(/,/g,'').match(/(\d+(?:\.\d+)?)/);
        if (!m) return; const coins = parseFloat(m[1]); if (!isFinite(coins)) return;
        const span = document.createElement('span');
        span.className = 'usd-suffix';
        span.style.fontSize = '0.7em'; span.style.marginLeft = '8px'; span.style.color = '#f0b90b';
        span.textContent = (lang()==='en' ? ` ($ ${fmt(coins*price)} USDT)` : `â‰ˆ$ ${fmt(coins*price)} USDT`);
        el.appendChild(span);
      }
      function annotate(price){
        if (!isFinite(price)) return;
        const nodes = document.querySelectorAll('.task-reward, .lottery-reward');
        nodes.forEach(el=>{
          const txt = el.textContent || '';
          if (/USDT/i.test(txt)) return;
          const m = txt.replace(/,/g,'').match(/(\d+(?:\.\d+)?)\s*(?:æš|coins)/i);
          if (!m) return; const coins = parseFloat(m[1]); if (!isFinite(coins)) return;
          const suffix = (lang()==='en' ? ` ($ ${fmt(coins*price)} USDT)` : `â‰ˆ$ ${fmt(coins*price)} USDT`);
          el.textContent = txt + ' ' + suffix;
        });
        annotateSummary(price);
      }
      try {
        fetch(API).then(r=>r.json()).then(d=>{
          const p = parseFloat(d && (d.price||d.lastPrice));
          annotate(p);
          try { buildLotteryValues(p); } catch(e) {}
          try { if (window.updateWeeklyTotalsWithPrice) window.updateWeeklyTotalsWithPrice(p); } catch(e) {}
        }).catch(()=>{});
      } catch(_) {}
    })();
  </script>

  <!-- Accordion toggle functionality -->
  <script>
    (function(){
      function initAccordion() {
        const headers = document.querySelectorAll('.week-header');

        headers.forEach(header => {
          header.addEventListener('click', function() {
            const content = this.nextElementSibling;
            const toggle = this.querySelector('.week-toggle');
            const isExpanded = content.classList.contains('expanded');

            // Toggle current accordion
            if (isExpanded) {
              content.classList.remove('expanded');
              this.classList.remove('active');
              toggle.classList.remove('expanded');
            } else {
              content.classList.add('expanded');
              this.classList.add('active');
              toggle.classList.add('expanded');
            }
          });
        });
      }

      // Initialize after DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initAccordion);
      } else {
        initAccordion();
      }
    })();
  </script>

  <!-- Auto-calculate weekly totals -->
  <script>
    (function(){
      function calculateWeeklyTotals(price) {
        const accordions = document.querySelectorAll('.week-accordion');
        function fmt(n){ try { return (Math.round(n*10)/10).toFixed(1); } catch(_) { return String(n); } }
        function lang(){ try { return localStorage.getItem('calendar_lang') || 'zh'; } catch(_){ return 'zh'; } }

        accordions.forEach(accordion => {
          const tasksGrid = accordion.querySelector('.week-tasks-grid');
          const totalElement = accordion.querySelector('.week-total');

          if (!tasksGrid || !totalElement) return;

          const rewards = tasksGrid.querySelectorAll('.task-reward');
          let total = 0;

          rewards.forEach(reward => {
            const match = (reward.textContent || '').match(/(\d+)/);
            if (match) {
              total += parseInt(match[1], 10);
            }
          });

          // Update total display
          if (total > 0) {
            let displayText = total + ' XNY';

            // Add USDT price if available
            if (isFinite(price) && price > 0) {
              const usdValue = fmt(total * price);
              displayText += (lang() === 'en' ? ` ($ ${usdValue})` : ` (â‰ˆ$ ${usdValue})`);
            }

            totalElement.textContent = displayText;
          }
        });
      }

      try {
        // Run after rewards are normalized
        setTimeout(() => calculateWeeklyTotals(), 100);

        // Update with price when available
        window.updateWeeklyTotalsWithPrice = calculateWeeklyTotals;
      } catch(e) {}
    })();
  </script>

  <script src="scripts/analytics.js" defer></script>
</body>
</html>
